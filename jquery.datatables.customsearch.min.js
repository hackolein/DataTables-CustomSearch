!function(e,t,i){"use strict";var n=function(e,t){var n=function(t,i){var a=this;if(!(this instanceof n))throw'Warning: CustomSearch must be initialised with the keyword "new".';if(!e.fn.dataTableExt.fnVersionCheck("1.10.0"))throw"Warning: CustomSearch requires DataTables 1.10 or greater.";return this.c={global:{},fields:[],container:"",hideStandardSearch:!0},this.s={dt:null,init:null,table:null},e(t).on("init.dt-custom-search",function(){a.init(t,i)}),this};return n.prototype={init:function(a,s){var l,r,d,o,h,c,u,f,m,p,g,b=this,y=[];if(this.s.dt=new t.Api(a).settings()[0],this.s.init=s||{},this.s.table=e(this.s.dt.nTable),e.extend(!0,this.c,n.defaults,s),this.c.hideStandardSearch===!0&&e("#"+this.s.dt.sInstance+"_filter").hide(),null===this.c.fields||this.c.fields===i||0===this.c.fields.length)for(this.c.fields=[],l=0;l<this.s.dt.aoColumns.length;l++)this.c.fields.push(l);for(e.isArray(this.c.fields)||(this.c.fields=[this.c.fields]),l=0;l<this.c.fields.length;l++)h=this.c.fields[l],(!isNaN(h)||e.isArray(h))&&(h={columns:h}),h=e.extend(!0,{},this.c.global,h),h.columns=e.isArray(h.columns)?h.columns:[h.columns],h.columns.sort(),h.multiple=this.getMultiple(h.multiple),h.type=this.getType(h.type,h.columns),h.dataType=this.getDataType(h.columns),h.range=this.getRange(h.range),h.dateFormat=this.getDateFormat(h.dateFormat),h.slider=h.slider===!0&&this.hasRange("min",h.range)&&this.hasRange("max",h.range),h.label=this.getLabel(h.label,h.range,h.columns,h.slider),h.id=this.getId(l,h.range,h.field,h.slider),h.advanced=this.getAdvanced(h.advanced,h.range,h.id,h.type),h.server=this.getServer(h.server,h.id),h.caseInsensitive=h.caseInsensitive!==!1,h.smart=h.smart===!0,h.autocomplete=h.autocomplete===!0,h.chosen=h.chosen===!0,h.trigger="key"===h.trigger?"keyup":"change",h=this.getField(h),this.c.fields[l]=h,y.push(h.fullField);if(this.c.fields.sort(this.sortBySubArray),"thead"===this.c.container||"tfoot"===this.c.container){if(c=this.c.container.indexOf("thead")>=0?"thead":"tfoot",u=this.s.table.find(c),g=u.find("tr"),0===u.length)for(this.s.table.append("<"+c+">"),u=this.s.table.find(c),g=e("<tr>").appendTo(u),l=0;l<this.s.dt.aoColumns.length;l++)g.append(e("<th>").toggle(this.s.dt.aoColumns[l].bVisible));for(l=0;l<this.c.fields.length;l++)g.find("th").eq(this.c.fields[l].columns[0]).append(this.c.fields[l].field)}else if("thead:before"===this.c.container||"thead:after"===this.c.container||"tfoot:before"===this.c.container||"tfoot:after"===this.c.container)for(c=this.c.container.indexOf("thead")>=0?"thead":"tfoot",u=this.s.table.find(c),f=0,m=1,p="prependTo",this.c.container===c+":after"&&(p="appendTo"),0===u.length&&this.s.table.append("<"+c+">"),u=this.s.table.find(c),g=e("<tr>")[p](u),l=0;l<this.c.fields.length;l++)for(r=0;r<this.c.fields[l].columns.length;r++){for(;this.c.fields[l].columns[r]>f;)g.append(e("<td>")),f++;if(1===this.c.fields[l].columns.length)g.append(e("<td>").append(this.c.fields[l].field));else{for(m=1,d=r+1;d<this.c.fields[l].columns.length&&this.c.fields[l].columns[d]===this.c.fields[l].columns[r]+1;d++)m++,f++;g.append(e("<td>").attr("colspan",m).append(e(this.c.fields[l].field))),r=d}f++}else this.c.container?e(this.c.container).append("<div>"+y.join("")+"</div>"):e(this.s.dt.nTableWrapper).prepend("<div>"+y.join("")+"</div>");for(l=0;l<this.c.fields.length;l++)h=this.c.fields[l],h.autocomplete?e("#"+h.id).autocomplete({source:b.getDistinctValuesInColumn(h.columns,h.dataType,!0),select:function(t,i){e(this).val(i.item.label),b.triggerSearch()}})[h.trigger](function(){b.triggerSearch()}):h.slider?(r=this.getDistinctValuesInColumn(h.columns,h.dataType,!0),e("#"+h.id).slider({min:b.intParse(r[0]),max:b.intParse(r[r.length-1]),values:[b.intParse(r[0]),b.intParse(r[r.length-1])],range:!0,slide:function(t,i){e("#"+this.id+"_display").text(i.values[0]+" - "+i.values[1]),b.triggerSearch()}}),e("#"+h.id+"_display").text(r[0]+" - "+r[r.length-1])):(o=[],0===h.range.length?o.push(h.id):(h.id.min&&o.push(h.id.min),h.id.max&&o.push(h.id.max)),e("#"+o.join(",#"))[h.trigger](function(){b.triggerSearch()}),h.chosen&&e("#"+o.join(",#")).chosen({allow_single_deselect:!0,width:"100%"}),"switch"===h.type&&e("#"+h.id).buttonset());this.s.dt.oInit.serverSide||this.s.table.dataTable().DataTable.ext.search.push(function(e,t,i){return e.nTable.id===b.s.dt.nTable.id?b.search(e,t,i):!0}),e.isFunction(this.c.after)&&this.s.table.on("search.dt",function(e,t){var i,n=t.aiDisplay,a=b.s.table.DataTable().data(),s=[],l=[],r=t._iDisplayStart+t._iDisplayLength;for(r>a.length&&(r=a.length),r>n.length&&(r=n.length),i=t._iDisplayStart;r>i;i++)s.push(a[n[i]]);for(i=0;i<n.length;i++)l.push(a[n[i]]);b.c.after(s,l,a)})},search:function(t,i){var n,a,s,l,r,d,o,h;for(n=0;n<this.c.fields.length;n++)if(d=this.c.fields[n],h=d.advanced?e("#"+d.advanced.id).val():!1,0===d.range.length){if("switch"===d.type?(l=[],e("#"+d.id+" input:checked").each(function(){l.push(e(this).val())})):l=e("#"+d.id).val(),l||(l=""),l.length){if(s=!1,"date"!==d.type||h){for(o=[],a=0;a<d.columns.length;a++)o.push(i[d.columns[a]]);this.searchString(o.join(" "),l,h,d.caseInsensitive,d.smart)&&(s=!0)}else for(a=0;a<d.columns.length;a++)if(this.searchDate(i[d.columns[a]],l,d.dateFormat)){s=!0;break}if(s===!1)return!1}}else if(r=d.slider?{min:e("#"+d.id).slider("values",0),max:e("#"+d.id).slider("values",1)}:{min:this.hasRange("min",d.range)?e("#"+d.id.min).val():"",max:this.hasRange("max",d.range)?e("#"+d.id.max).val():""},r.min||(r.min=""),r.max||(r.max=""),r.min||r.max){for(s=!1,a=0;a<d.columns.length;a++)if("date"===d.type){if(this.searchDateRange(i[d.columns[a]],r,d.dateFormat)){s=!0;break}}else if(this.searchNumberRange(i[d.columns[a]],r)){s=!0;break}if(s===!1)return!1}return!0},searchString:function(e,t,i,n,a){var s=!1;return s=null!==t&&t.length?this.searchStringAdvanced(e,t,i,n,a):!0},searchStringAdvanced:function(t,i,n,a){var s,l,r;for(a&&(t=t.toLowerCase()),l=this.intParse(t),e.isArray(i)||(i=[i]),s=0;s<i.length;s++){if(a&&(i[s]=i[s].toLowerCase()),r=this.intParse(i[s]),!(n&&"contains"!==n||-1===t.search(i[s])))return!0;if("not-contains"===n&&-1===t.search(i[s]))return!0;if("equal"===n&&t===i[s])return!0;if("not-equal"===n&&t!==i[s])return!0;if("greater"===n&&l>r)return!0;if("less"===n&&r>l)return!0;if("begins"===n&&0===t.indexOf(i[s]))return!0}return!1},searchNumberRange:function(e,t){return e=this.intParse(e),t.min=this.intParse(t.min),t.max=this.intParse(t.max),isNaN(e)?!1:isNaN(t.min)&&isNaN(t.max)||isNaN(t.min)&&t.max>=e||t.min<=e&&isNaN(t.max)||t.min<=e&&t.max>=e},searchDate:function(e,t,i){return e=moment(e,i.cell),t=moment(e,i.input),e.isValid()===!1&&t.isValid()===!1?!1:e.isSame(t)},searchDateRange:function(e,t,i){return e=moment(e,i.cell),e.isValid()===!1?!1:""!=t.min&&""!=t.max&&(t.min=moment(t.min,i.cell),t.max=moment(t.max,i.cell),t.min.isValid()===!0&&t.max.isValid()===!0)?!t.min.isAfter(t.max)&&(e.isBetween(e.isAfter(t.min),t.max)||e.isSame(t.min)||e.isBetween(t.min,t.max)||e.isSame(t.max)):""!=t.min&&(t.min=moment(t.min,i.cell),t.min.isValid()===!0)?e.isAfter(t.min)||e.isSame(t.min):""!=t.max&&(t.max=moment(t.max,i.cell),t.max.isValid()===!0)?e.isBefore(t.max)||e.isSame(t.max):void 0},getRange:function(t){var n=[],a=!1,s=!1;return"string"==typeof t&&(n=t.split(",")),e.isArray(t)&&(a=this.hasRange("min",t),s=this.hasRange("max",t),n=a&&s?["min","max"]:a&&!s?["min"]:!a&&s?["max"]:[]),t===i&&(n=[]),t===!0&&(n=["min","max"]),n},getDateFormat:function(e){var t={cell:"YYYY-MM-DD",input:"YYYY-MM-DD"};return null!==e&&"undefined"!=typeof e&&"object"==typeof e&&(e.hasOwnProperty("cell")===!0&&(t.cell=e.cell),e.hasOwnProperty("input")===!0&&(t.input=e.input)),t},getField:function(t){var i=e(t.field);return t.field&&0!==i.length||(i=this.createField(t)),i},createField:function(t){var i;switch(t.fieldLabel=[],t.field=[],t.type){case"string":t.label&&(t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>"),t.field=t.advanced.field+'<input type="text" id="'+t.id+'">';break;case"number":case"date":0===t.range.length?(t.label&&(t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>"),t.field=t.advanced.field+'<input type="'+t.type+'" id="'+t.id+'">'):t.slider?(t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>",t.field=t.advanced.field+'<div id="'+t.id+'"></div><div id="'+t.id+'_display"></div>'):(this.hasRange("min",t.range)&&(t.label&&t.fieldLabel.push('<label for="'+t.id.min+'">'+t.label.min+"</label>"),t.field.push('<input type="'+t.type+'" id="'+t.id.min+'">')),this.hasRange("max",t.range)&&(t.label&&t.fieldLabel.push('<label for="'+t.id.max+'">'+t.label.max+"</label>"),t.field.push('<input type="'+t.type+'" id="'+t.id.max+'">')));break;case"select":for(t.label&&(t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>"),e.isArray(t.options)&&0!==t.options.length||(t.options=this.getDistinctValuesInColumn(t.columns,t.dataType,!0)),t.field=t.advanced.field+'<select id="'+t.id+'"',t.multiple&&(t.field+=' multiple="multiple"'),t.field+=">",t.multiple||t.options.unshift({value:"",text:t.chosen?"":"All"}),i=0;i<t.options.length;i++)t.field+="object"==typeof t.options[i]?'<option value="'+t.options[i].value+'">'+t.options[i].text+"</option>":'<option value="'+t.options[i]+'">'+t.options[i]+"</option>";t.field+="</select>";break;case"switch":for(e.isArray(t.options)&&0!==t.options.length||(t.options=this.getDistinctValuesInColumn(t.columns,t.dataType,!0)),i=0;i<t.options.length;i++)"object"==typeof t.options[i]?(t.field.push('<input type="checkbox" id="'+t.id+"_"+i+'" name="'+t.id+'"'+t.options[i].value+">"),t.field.push('<label for="'+t.id+"_"+i+'">'+t.options[i].text+"</label>")):(t.field.push('<input type="checkbox" id="'+t.id+"_"+i+'" name="'+t.id+'" value="'+t.options[i]+'">'),t.field.push('<label for="'+t.id+"_"+i+'">'+t.options[i]+"</label>"));t.field.unshift('<div id="'+t.id+'">'),t.field.push("</div>"),t.field=t.field.join("");break;default:throw"Warning: CustomSearch init failed due to invalid field type given - "+t.type}if(t.fullField="",e.isArray(t.field))for(i=0;i<t.field.length;i++)t.fullField+=t.fieldLabel[i],t.fullField+=t.field[i];else t.fullField+=t.fieldLabel,t.fullField+=t.field;return t},getDistinctValuesInColumn:function(t,i,n){var a=[],s=this;return e.each(this.s.dt.aoData,function(i,n){var s,l=[];if(e.isArray(t))for(s=0;s<t.length;s++)l.push(n._aData[t[s]]);else l.push(n._aData[t]);l=l.join(" "),-1===e.inArray(l,a)&&a.push(l)}),n&&("string"===i||"date"===i?a.sort():a.sort(function(e,t){return s.intParse(e)-s.intParse(t)})),a},getMultiple:function(e){return e===!0},intParse:function(e){return parseInt(e.toString().replace(/[^\d]/i,""),10)},getId:function(t,i,n,a){var s,l,r=this.s.dt.sInstance+"_"+t;return 0===i.length||a?s=r:(s={},this.hasRange("min",i)&&(s.min=r+"_min"),this.hasRange("max",i)&&(s.max=r+"_max")),e(n).length>0&&(l=e(n).attr("id"),l?s=l:e(n).attr("id",s)),s},getAdvanced:function(e,t,i,n){var a,s="",l=i+"_advanced",r="number"===n||"date"===n,d=[["contains","Contains",!r],["not-contains","Does Not Contain",!1],["equal","Is Equal To",r],["not-equal","Is Not Equal To",!1]];if(r?(d.push(["greater","Is Greather Than",!1]),d.push(["less","Is Less Than",!1])):d.push(["begins","Begins With",!1]),e===!0&&0===t.length){for(s+='<select id="'+l+'">',a=0;a<d.length;a++)s+='<option value="'+d[a][0]+'"',d[a][2]&&(s+=' selected="selected"'),s+=">"+d[a][1]+"</option>";return s+="</select>",{id:l,field:s}}return{id:"",field:""}},getServer:function(e,t){return e||t},getLabel:function(e,t,n,a){var s,l="";if(e===i){for(e=[],s=0;s<n.length;s++)e.push(this.s.dt.aoColumns[n[s]].sTitle);e=e.join(" & ")}return 0===t.length||a?l=e:(l={},this.hasRange("min",t)&&(l.min=e.hasOwnProperty("min")===!1?"Min "+e:e.min),this.hasRange("max",t)&&(l.max=e.hasOwnProperty("max")===!1?"Max "+e:e.max)),l},getType:function(e,t){var i=e;return i||(1===t.length?(i=this.s.dt.aoColumns[t[0]].sType,("num"===i||"currency"===i||"num-fmt"===i)&&(i="number")):i="string"),i.toLowerCase()},getDataType:function(e){var t="string";return 1===e.length&&(t=this.s.dt.aoColumns[e[0]].sType,("num"===t||"currency"===t||"num-fmt"===t)&&(t="number")),t.toLowerCase()},hasRange:function(t,i){return e.inArray(t,i)>=0},sortBySubArray:function(t,i){var n=t.columns,a=i.columns;return e.isArray(n)&&(n=Math.min.apply(Math,n)),e.isArray(a)&&(a=Math.min.apply(Math,a)),n-a},triggerSearch:function(){var t,i;if(this.s.dt.oInit.serverSide){for(t=this.s.dt.ajax,"string"==typeof t&&(t={url:t,data:{}}),t.data.customsearch={},i=0;i<this.c.fields.length;i++)t.data.customsearch[this.c.fields[i].server]=e("#"+this.c.fields[i].id).val();this.s.dt.ajax=t}this.s.table.DataTable().draw()}},t.CustomSearch=n,n};"function"==typeof define&&define.amd?define("datatables-customsearch",["jquery","datatables"],n):jQuery&&!jQuery.fn.dataTable.CustomSearch&&n(jQuery,jQuery.fn.dataTable),jQuery.fn.customSearch=function(e){return $(this.selector).each(function(){new jQuery.fn.dataTable.CustomSearch(this,e)}),this}}(window,document);